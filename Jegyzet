((tartalom)) -- nem olyan fontos

Group5.netsec.infra.inf.unideb.hu
login: root student

1. vlan konfigurálás: interfaces, devices, vlan -> interfaces, assigment -> vlan, enable interface, ne blokkoljunk semmit, ip cím -> services, dhcp

2. container, templateből, 1024 ram, egyéb

3. firewall, rules, <interfész>, (pl.) direction: vlan10 net

4. tűzfal portletiltás/átengedés; firewall, rules, direction, protocol, source, dest, port; sorrend fentről le

5. bastion host, /etc/hosts.allow, /etc/hosts.deny: sshd: ip/all; ssh-keygen kliensen; bastion-ben ./ssh/authorized_keys -be a kulcs;
.ssh/config kliensen:
Host bastion
  User student #célpont gépen név
  IdentityFile /home/student/.shh/bastion #saját gépen lévő fájl
  Port 22 #célpont nyitott portja
  HostName <ip> #célpont ipje
Host belso1
  User student
  IdentityFile /home/student/.ssh/bastion #lehet külön kulcs
  Port 22
  HostName <ip> #belső ip
  ProxyJump #melyik gépen keresztül lépek be
belső gépen ./ssh/authorized_keys -be a kulcs
bastion-ön és belső gépe(ke)n /etc/ssh/sshd_config: PasswordAuthentication no, majd systemctl restart ssh
((ubuntu server download online, linket bemásoljuk a proxmox local iso images és from url))

((6. monitoring rendszerek: System monitoring, Application monitoring, Intrusion detection/prevention software (IDS/IPS)
  Network IDS/IPS és Host IDS/IPS: Wazuh (ELK stackre épül)
  System monitoring (mindig host alapú): Zabbix és Nagios))

7. Wazzuh:
  docker -> containerization
  VM, megfelelő erőforrások, hálózatba bevonás
  rássh-zunk egy grafikus gépről (tűzfalon engedjük át), https://docs.docker.com/engine/install/ubuntu/ első három (apt-os download)
  felhasználó docker csoporthoz: sudo usermod -aG docker student, újracsatlakozol ssh-n
  wazzuh docker: https://documentation.wazuh.com/current/deployment-options/docker/wazuh-container.html , single node, git clone-os parancs, wazzuh self-signed certificates (optional nem számít), deployment
  wazuh agent: valamelyik másik gépre, https://documentation.wazuh.com/current/installation-guide/wazuh-agent/wazuh-agent-package-linux.html

8. Zabbix (Nagios)
  új container (név, jelszó, template, 20GB, 2, 1024Mb, hálózat/ip)
  sudo apt install mariadb-server, mysql_secure_installation (enter, Y, n, Y, Y, Y, Y), https://www.zabbix.com/download?zabbix=7.4&os_distribution=ubuntu&os_version=22.04&components=server_frontend_agent&db=mysql&ws=apache
  kiválasztjuk az opciókat, (jelszó és felhasználónevet átírjuk) create user zabbix@localhost identified by 'password'; , zcat parancs hosszú ideig fut és módosítsuk a felhasználónevet ha kell, jelszó amit most adtunk meg
  dockerben locale-gen "en-US", dpkg-reconfigure locales és kiválasztjuk az en-US UTF-8-as verziót, default-nak betesszük, majd reboot
  megnyitjuk ip/zabbix webhelyet (Admin/zabbix), next, beállítunk mindent (vagy csak a jelszót), szervernévnek valami, időzóna -> belépünk
  agent telepítés, ugyan az a weboldal csak agent-öt választunk, telepítés után nano /etc/zabbix/zabbix_agentd.conf és beírjuk a jó helyre a szerver ipjét, majd agent-öt újraindítjuk
  Networking, Hosts, Create host, név, template group, Linux by Zabbix, host groups, linux servers, interfaces: agent és az agent ip címe (confirmölés után online-nak kell lennie egy kis idő után)
  Monitoring, triggers, new trigger, add condition

9. Ansible
  ((még Puppet, Chef; Ansible GUI az a Semaphore UI))
  Ansible előnye hogy nem kellenek ágensek, csak ssh kell
  https://docs.ansible.com/ansible/latest/installation_guide/installation_distros.html (ubuntu része)
  cd ./etc/ansible
  nano hosts,
    [csoport]
    <ip>
    <ip>
    ...
    [csoport:vars]
    ansible_user=
    ansible_password=
    #csak ha kell rendszergazdai jog
    ansible_become_user= 
    #su - rendszergazda jelszava; sudo - felhasználó jelszava (sudo-nál usermod -aG sudo <felhasználó> a megfelelő felhasználóra)
    ansible_become_method=
    ansible_become_password=
  nano ansible.cfg
    [defaults]
    host_key_checking = false #kényelmi beállítás
  ansible all -m ansible.builtin.ping (megnézi hogy elérhetőek-e a gépek) (ssh-t állítsunk ha nem enged)
  ansible all -m ansible.builtin.command whoami
  https://arato.inf.unideb.hu/bertok.csanad/ playbook-okhoz példa
    alap struktúránál ha a tasks felé beírjuk a "become: true" akkor rendszergazdaként is futtathatunk
    ansible playbook <playbook.yml>
      -e <változó=érték> -- amit átadunk a playbooknak
    chatgpt további segítségnek

DECEMBER 2 ZH

tippek:
  routereket klónozni gyorsabb
  neveket őrizzük meg
  
pl. feladatra
  első router: create vm, bridge vmbr1
  (proxmox csoportra kattintva) create linux bridge, vmbr2, vlan aware
  routernél add network device, vmbr2
  routert elindítjuk, telepítjük,
